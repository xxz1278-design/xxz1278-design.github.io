{
  "hash": "7bfd5123e6d431dfec11238cf36a7626",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"data\"\nformat: html\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(nhanesA)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.2     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.1.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndemo_raw <- nhanes('P_DEMO') |> tibble()\nprint(head(demo_raw))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 29\n    SEQN SDDSRVYR RIDSTATR RIAGENDR RIDAGEYR RIDAGEMN RIDRETH1 RIDRETH3 RIDEXMON\n   <dbl> <fct>    <fct>    <fct>       <dbl>    <dbl> <fct>    <fct>    <fct>   \n1 109263 NHANES … Both in… Male            2       NA Other R… Non-His… May 1 t…\n2 109264 NHANES … Both in… Female         13       NA Mexican… Mexican… May 1 t…\n3 109265 NHANES … Both in… Male            2       NA Non-His… Non-His… May 1 t…\n4 109266 NHANES … Both in… Female         29       NA Other R… Non-His… May 1 t…\n5 109267 NHANES … Intervi… Female         21       NA Other H… Other H… <NA>    \n6 109268 NHANES … Intervi… Female         18       NA Non-His… Non-His… <NA>    \n# ℹ 20 more variables: DMDBORN4 <fct>, DMDYRUSZ <fct>, DMDEDUC2 <fct>,\n#   DMDMARTZ <fct>, RIDEXPRG <fct>, SIALANG <fct>, SIAPROXY <fct>,\n#   SIAINTRP <fct>, FIALANG <fct>, FIAPROXY <fct>, FIAINTRP <fct>,\n#   MIALANG <fct>, MIAPROXY <fct>, MIAINTRP <fct>, AIALANGA <fct>,\n#   WTINTPRP <dbl>, WTMECPRP <dbl>, SDMVPSU <dbl>, SDMVSTRA <dbl>,\n#   INDFMPIR <dbl>\n```\n\n\n:::\n\n```{.r .cell-code}\nsaveRDS(demo_raw, \"data/P_DEMO.Rds\")\ndemo_raw <- readRDS(\"data/P_DEMO.Rds\")\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbp_raw <- nhanes('P_BPXO') |> tibble()\nprint(head(bp_raw))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 12\n    SEQN BPAOARM BPAOCSZ         BPXOSY1 BPXODI1 BPXOSY2 BPXODI2 BPXOSY3 BPXODI3\n   <dbl> <fct>   <fct>             <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n1 109264 \"Right\" 22-31.9 (bladd…     109      67     109      68     106      66\n2 109266 \"Right\" 32-41.9 (bladd…      99      56      99      55      99      52\n3 109270 \"Right\" 22-31.9 (bladd…     123      73     124      77     127      70\n4 109271 \"Right\" 32-41.9 (bladd…     102      65     108      68     111      68\n5 109273 \"Right\" 22-31.9 (bladd…     116      68     110      66     115      68\n6 109274 \"\"      22-31.9 (bladd…     138      70     132      69     132      71\n# ℹ 3 more variables: BPXOPLS1 <dbl>, BPXOPLS2 <dbl>, BPXOPLS3 <dbl>\n```\n\n\n:::\n\n```{.r .cell-code}\nsaveRDS(bp_raw, \"data/P_BPXO.Rds\")\nbp_raw <- readRDS(\"data/P_BPXO.Rds\")\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchol_raw <- nhanes('P_TRIGLY') |> tibble()\nprint(head(chol_raw))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 10\n    SEQN WTSAFPRP LBXTR LBDTRSI LBDLDL LBDLDLSI LBDLDLM LBDLDMSI LBDLDLN\n   <dbl>    <dbl> <dbl>   <dbl>  <dbl>    <dbl>   <dbl>    <dbl>   <dbl>\n1 109264   27533.    40   0.452     86     2.22      82     2.12      85\n2 109271   18101.    84   0.948     97     2.51      96     2.48      98\n3 109274   16282.   133   1.50      49     1.27      54     1.40      52\n4 109277   32230.    24   0.271     64     1.66      62     1.60      61\n5 109282   79007.   132   1.49     164     4.24     163     4.22     166\n6 109286       0    192   2.17     131     3.39     136     3.52     135\n# ℹ 1 more variable: LBDLDNSI <dbl>\n```\n\n\n:::\n\n```{.r .cell-code}\nsaveRDS(chol_raw, \"data/P_TRIGLY.Rds\")\nchol_raw <- readRDS(\"data/P_TRIGLY.Rds\")\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npa_raw <- nhanes('P_PAQ') |> tibble()\nprint(head(pa_raw))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 17\n    SEQN PAQ605 PAQ610 PAD615 PAQ620 PAQ625 PAD630 PAQ635 PAQ640 PAD645 PAQ650\n   <dbl> <fct>   <dbl>  <dbl> <fct>   <dbl>  <dbl> <fct>   <dbl>  <dbl> <fct> \n1 109266 No         NA     NA No         NA     NA No         NA     NA Yes   \n2 109267 No         NA     NA No         NA     NA No         NA     NA Yes   \n3 109268 Yes         5    540 Yes         5    300 No         NA     NA No    \n4 109271 No         NA     NA Yes         2    120 No         NA     NA No    \n5 109273 Yes         3    240 No         NA     NA No         NA     NA No    \n6 109274 Yes         7    480 Yes         6    360 Yes         7     60 No    \n# ℹ 6 more variables: PAQ655 <dbl>, PAD660 <dbl>, PAQ665 <fct>, PAQ670 <dbl>,\n#   PAD675 <dbl>, PAD680 <dbl>\n```\n\n\n:::\n\n```{.r .cell-code}\nsaveRDS(pa_raw, \"data/P_PAQ.Rds\")\npa_raw <- readRDS(\"data/P_PAQ.Rds\")\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbs_raw <- nhanes('P_GLU') |> tibble()\nprint(head(bs_raw))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 4\n    SEQN WTSAFPRP LBXGLU LBDGLUSI\n   <dbl>    <dbl>  <dbl>    <dbl>\n1 109264   27533.     97     5.38\n2 109271   18101.    103     5.72\n3 109274   16282.    154     8.55\n4 109277   32230.     92     5.11\n5 109282   79007.     95     5.27\n6 109286       0      92     5.11\n```\n\n\n:::\n\n```{.r .cell-code}\nsaveRDS(bs_raw, \"data/P_GLU.Rds\")\nbs_raw <- readRDS(\"data/P_GLU.Rds\")\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nNEW_merged_data <- demo_raw %>%\n  left_join(bp_raw, by = \"SEQN\") %>%\n  left_join(pa_raw, by = \"SEQN\") %>%\n  left_join(chol_raw, by = \"SEQN\") %>%\n  left_join(bs_raw, by = \"SEQN\")\n\nsaveRDS(NEW_merged_data, \"data/NEW_merged_data.Rds\")\n\nprint(head(NEW_merged_data))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 68\n    SEQN SDDSRVYR RIDSTATR RIAGENDR RIDAGEYR RIDAGEMN RIDRETH1 RIDRETH3 RIDEXMON\n   <dbl> <fct>    <fct>    <fct>       <dbl>    <dbl> <fct>    <fct>    <fct>   \n1 109263 NHANES … Both in… Male            2       NA Other R… Non-His… May 1 t…\n2 109264 NHANES … Both in… Female         13       NA Mexican… Mexican… May 1 t…\n3 109265 NHANES … Both in… Male            2       NA Non-His… Non-His… May 1 t…\n4 109266 NHANES … Both in… Female         29       NA Other R… Non-His… May 1 t…\n5 109267 NHANES … Intervi… Female         21       NA Other H… Other H… <NA>    \n6 109268 NHANES … Intervi… Female         18       NA Non-His… Non-His… <NA>    \n# ℹ 59 more variables: DMDBORN4 <fct>, DMDYRUSZ <fct>, DMDEDUC2 <fct>,\n#   DMDMARTZ <fct>, RIDEXPRG <fct>, SIALANG <fct>, SIAPROXY <fct>,\n#   SIAINTRP <fct>, FIALANG <fct>, FIAPROXY <fct>, FIAINTRP <fct>,\n#   MIALANG <fct>, MIAPROXY <fct>, MIAINTRP <fct>, AIALANGA <fct>,\n#   WTINTPRP <dbl>, WTMECPRP <dbl>, SDMVPSU <dbl>, SDMVSTRA <dbl>,\n#   INDFMPIR <dbl>, BPAOARM <fct>, BPAOCSZ <fct>, BPXOSY1 <dbl>, BPXODI1 <dbl>,\n#   BPXOSY2 <dbl>, BPXODI2 <dbl>, BPXOSY3 <dbl>, BPXODI3 <dbl>, …\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(dim(NEW_merged_data))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 15560    68\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclean_data_adults <- NEW_merged_data %>%\n  filter(RIDSTATR == \"Both interviewed and MEC examined\") %>%       \n  filter(RIDAGEYR < 80) %>%       \n  filter(RIDAGEYR >= 21)          \n\ncat(\"case #:\", nrow(clean_data_adults), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ncase #: 7853 \n```\n\n\n:::\n\n```{.r .cell-code}\nprint(head(clean_data_adults))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 68\n    SEQN SDDSRVYR RIDSTATR RIAGENDR RIDAGEYR RIDAGEMN RIDRETH1 RIDRETH3 RIDEXMON\n   <dbl> <fct>    <fct>    <fct>       <dbl>    <dbl> <fct>    <fct>    <fct>   \n1 109266 NHANES … Both in… Female         29       NA Other R… Non-His… May 1 t…\n2 109271 NHANES … Both in… Male           49       NA Non-His… Non-His… May 1 t…\n3 109273 NHANES … Both in… Male           36       NA Non-His… Non-His… May 1 t…\n4 109274 NHANES … Both in… Male           68       NA Other R… Other R… Novembe…\n5 109282 NHANES … Both in… Male           76       NA Non-His… Non-His… May 1 t…\n6 109284 NHANES … Both in… Female         44       NA Mexican… Mexican… Novembe…\n# ℹ 59 more variables: DMDBORN4 <fct>, DMDYRUSZ <fct>, DMDEDUC2 <fct>,\n#   DMDMARTZ <fct>, RIDEXPRG <fct>, SIALANG <fct>, SIAPROXY <fct>,\n#   SIAINTRP <fct>, FIALANG <fct>, FIAPROXY <fct>, FIAINTRP <fct>,\n#   MIALANG <fct>, MIAPROXY <fct>, MIAINTRP <fct>, AIALANGA <fct>,\n#   WTINTPRP <dbl>, WTMECPRP <dbl>, SDMVPSU <dbl>, SDMVSTRA <dbl>,\n#   INDFMPIR <dbl>, BPAOARM <fct>, BPAOCSZ <fct>, BPXOSY1 <dbl>, BPXODI1 <dbl>,\n#   BPXOSY2 <dbl>, BPXODI2 <dbl>, BPXOSY3 <dbl>, BPXODI3 <dbl>, …\n```\n\n\n:::\n\n```{.r .cell-code}\nsaveRDS(clean_data_adults, \"data/clean_adult_data.Rds\")\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate mean SBP/DBP and BP level\nfinal_data <- clean_data_adults %>%\n   mutate(\n    Mean_SBP = rowMeans(select(., BPXOSY1, BPXOSY2, BPXOSY3), na.rm = TRUE),\n    Mean_DBP = rowMeans(select(., BPXODI1, BPXODI2, BPXODI3), na.rm = TRUE) )%>%\n  \n  mutate(\n    BP_Category = case_when(\n      (Mean_SBP >= 140) | (Mean_DBP >= 90) ~ \"4. Stage 2 Hypertension (>=140 or >=90)\",\n      (Mean_SBP >= 130 & Mean_SBP < 140) | (Mean_DBP >= 80 & Mean_DBP < 90) ~ \"3. Stage 1 Hypertension (130-139 or 80-89)\",\n      (Mean_SBP >= 120 & Mean_SBP < 130) & (Mean_DBP < 80) ~ \"2. Elevated (120-129 and <80)\",\n      (Mean_SBP < 120) & (Mean_DBP < 80) ~ \"1. Normal (<120 and <80)\",\n      TRUE ~ NA_character_\n    )\n  ) %>%\n  mutate(\n    BP_Category = factor(BP_Category, levels = c(\n      \"1. Normal (<120 and <80)\",\n      \"2. Elevated (120-129 and <80)\",\n      \"3. Stage 1 Hypertension (130-139 or 80-89)\",\n      \"4. Stage 2 Hypertension (>=140 or >=90)\"\n    ))\n  )\n\nprint(table(final_data$BP_Category, useNA = \"ifany\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n                  1. Normal (<120 and <80) \n                                      3025 \n             2. Elevated (120-129 and <80) \n                                      1000 \n3. Stage 1 Hypertension (130-139 or 80-89) \n                                      1540 \n   4. Stage 2 Hypertension (>=140 or >=90) \n                                      1518 \n                                      <NA> \n                                       770 \n```\n\n\n:::\n\n```{.r .cell-code}\n#Chol level\nfinal_data <- final_data %>%\n  mutate(\n    LDL_Category = case_when(\n      LBDLDL >= 160 ~ \"4. Very High Risk (>=160)\",\n      LBDLDL >= 130 & LBDLDL < 160 ~ \"3. High Risk (130-159)\",\n      LBDLDL >= 100 & LBDLDL < 130 ~ \"2. Borderline (100-129)\",\n      LBDLDL < 100 ~ \"1. Optimal (<100)\",\n      TRUE ~ NA_character_\n    )\n  ) %>%\n  mutate(\n    LDL_Category = factor(LDL_Category, levels = c(\n      \"1. Optimal (<100)\",\n      \"2. Borderline (100-129)\",\n      \"3. High Risk (130-159)\",\n      \"4. Very High Risk (>=160)\"\n    ))\n  )\n\nprint(table(final_data$LDL_Category, useNA = \"ifany\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n        1. Optimal (<100)   2. Borderline (100-129)    3. High Risk (130-159) \n                     1521                      1156                       627 \n4. Very High Risk (>=160)                      <NA> \n                      297                      4252 \n```\n\n\n:::\n\n```{.r .cell-code}\nsaveRDS(final_data, \"data/final_data.Rds\")\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfinal_data <- readRDS(\"data/final_data.Rds\") %>%\n  select(\n    #Demo\n    SEQN,\n    RIDSTATR,\n    Age = RIDAGEYR,\n    Gender = RIAGENDR,\n    #Key variables\n    Mean_SBP, \n    Mean_DBP,\n    BP_Category,\n    Sedentary_Mins = PAD680,\n    LDL_Cholesterol = LBDLDL,\n    LDL_Category,\n    Triglycerides = LBXTR,\n    Fasting_Glucose = LBXGLU\n  )%>%\n  #converting na\n  mutate(\n    Sedentary_Mins = na_if(Sedentary_Mins, 7777),\n    Sedentary_Mins = na_if(Sedentary_Mins, 9999)\n  )%>%\n  drop_na() \n\nfinal_n <- nrow(final_data)\ncat(\"Study 1 case number:\", final_n, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nStudy 1 case number: 3251 \n```\n\n\n:::\n\n```{.r .cell-code}\nprint(head(final_data))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 12\n    SEQN RIDSTATR        Age Gender Mean_SBP Mean_DBP BP_Category Sedentary_Mins\n   <dbl> <fct>         <dbl> <fct>     <dbl>    <dbl> <fct>                <dbl>\n1 109271 Both intervi…    49 Male       107      67   1. Normal …             60\n2 109274 Both intervi…    68 Male       134      70   3. Stage 1…            300\n3 109282 Both intervi…    76 Male       139.     72.7 3. Stage 1…            900\n4 109290 Both intervi…    68 Female     121.     60.3 2. Elevate…            180\n5 109292 Both intervi…    58 Male       138      97   4. Stage 2…            600\n6 109297 Both intervi…    30 Female     104      69.7 1. Normal …            600\n# ℹ 4 more variables: LDL_Cholesterol <dbl>, LDL_Category <fct>,\n#   Triglycerides <dbl>, Fasting_Glucose <dbl>\n```\n\n\n:::\n\n```{.r .cell-code}\nsaveRDS(final_data, \"data/final_variables.rds\")\n```\n:::\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}